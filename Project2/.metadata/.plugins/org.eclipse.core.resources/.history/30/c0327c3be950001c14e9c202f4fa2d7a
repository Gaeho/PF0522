<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>

<!DOCTYPE html>
<html>
<head>
<link href="css/dj/annoWriteForm.css" rel="stylesheet" type="text/css">
<link href="css/header.css" rel="stylesheet" type="text/css">
<link href="css/reset.css" rel="stylesheet" type="text/css">

<meta charset="UTF-8">
<title>공고작성</title>
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript">
	function buttontoggle(){
		
		var t = document.getElementById("pay_info")
		
		if(parseInt(t.value) >= 0){
			t.value = '-1'
				pay_info.disabled = true;
	
		}else if(parseInt(t.value) < 0){
			t.value = '0'
			
				pay_info.disabled = false;
		}
	}
	
	function addMonth(){
/* 		var anno_regdate =  $('#anno_regdate').val();
		var anno_regdate3 = new Date(anno_regdate);
		var anno_c_regdate = new Date(anno_regdate3.setMonth(anno_regdate3.getMonth() + 1));	// 한달 후

		alert('anno_c_regdate->'+anno_c_regdate);
		$('[name="anno_c_regdate"]').val(anno_c_regdate);
 */
		 var regdate = document.getElementById("regdate").value;
		  console.log(regdate);
		  var c = new Date(regdate);
		  console.log(c);
		  var c_regdate = new Date(c.setMonth(c.getMonth() + 1));
		  console.log(c_regdate);
		  document.getElementById("c_regdate").valueAsDate = c_regdate;	
 
		 var regdateValidate = document.getElementById("c_regdate").value;
			alert('regdateValidate->'+regdateValidate);
	}
	
	/* 이하 이미지 input을 위한 ajax와 함수들 */
	
	var fileArr;
var fileInfoArr=[];

//썸네일 클릭시 삭제.
function fileRemove(index) {
    console.log("index: "+index);
    fileInfoArr.splice(index,1);
 
    var imgId="#img_id_"+index;
    $(imgId).remove();
    console.log(fileInfoArr);
}

//썸네일 미리보기.
function previewImage(targetObj, View_area) {
    var files=targetObj.files;
    fileArr=Array.prototype.slice.call(files);
    
    var preview = document.getElementById(View_area); //div id
    var ua = window.navigator.userAgent;
 
    //ie일때(IE8 이하에서만 작동)
    if (ua.indexOf("MSIE") > -1) {
        targetObj.select();
        try {
            var src = document.selection.createRange().text; // get file full path(IE9, IE10에서 사용 불가)
            var ie_preview_error = document.getElementById("ie_preview_error_" + View_area);
 
 
            if (ie_preview_error) {
                preview.removeChild(ie_preview_error); //error가 있으면 delete
            }
 
            var img = document.getElementById(View_area); //이미지가 뿌려질 곳
 
            //이미지 로딩, sizingMethod는 div에 맞춰서 사이즈를 자동조절 하는 역할
            img.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+src+"', sizingMethod='scale')";
        } catch (e) {
            if (!document.getElementById("ie_preview_error_" + View_area)) {
                var info = document.createElement("<p>");
                info.id = "ie_preview_error_" + View_area;
                info.innerHTML = e.name;
                preview.insertBefore(info, null);
            }
        }
        //ie가 아닐때(크롬, 사파리, FF)
    } else {
        var files = targetObj.files;
        for ( var i = 0; i < files.length; i++) {
            var file = files[i];
            fileInfoArr.push(file);
 
            var imageType = /image.*/; //이미지 파일일경우만.. 뿌려준다.
            if (!file.type.match(imageType))
                continue;
            // var prevImg = document.getElementById("prev_" + View_area); //이전에 미리보기가 있다면 삭제
            // if (prevImg) {
            //     preview.removeChild(prevImg);
            // }
 
            var span=document.createElement('span');
            span.id="img_id_" +i;
            span.style.width = '100px';
            span.style.height = '100px';
            preview.appendChild(span);
 
            var img = document.createElement("img");
            img.className="addImg";
            img.classList.add("obj");
            img.file = file;
            img.style.width='inherit';
            img.style.height='inherit';
            img.style.cursor='pointer';
            const idx=i;
            img.onclick=()=>fileRemove(idx);   //이미지를 클릭했을 때.
            span.appendChild(img);
 
            if (window.FileReader) { // FireFox, Chrome, Opera 확인.
                var reader = new FileReader();
                reader.onloadend = (function(aImg) {
                    return function(e) {
                        aImg.src = e.target.result;
                    };
                })(img);
                reader.readAsDataURL(file);
            } else { // safari is not supported FileReader
                //alert('not supported FileReader');
                if (!document.getElementById("sfr_preview_error_"
                    + View_area)) {
                    var info = document.createElement("p");
                    info.id = "sfr_preview_error_" + View_area;
                    info.innerHTML = "not supported FileReader";
                    preview.insertBefore(info, null);
                }
            }
        }
    }
}


출처: https://chung-develop.tistory.com/14 [춍춍 블로그]
	
	

	/* 이상 이미지 input을 위한 ajax와 함수들 */
	
	
</script>
</head>
<body>
	<div class="Container">
		<div class="MyContainer">
			<%@ include file="header.jsp"%>
			<br>
			<br>

			<div class="annoWrite_title">공고 작성하기</div>
			<p>
			<hr size="5px">

			<div class="compInfoContainer">
				<div class="bigTitle_anno">회사 정보</div>

				<div>
					<div class="middleTitle_anno">회사명</div>
					<div class="anno1_ctx">${compInfo.com_name}</div>
				</div>
				<p>
				<div>
					<div class="middleTitle_anno">주요 사업 내용</div>
					<div class="combus_ctx">${compInfo.com_bus}</div>
				</div>
				<p>

					<%-- <label for="complogo1" >회사 로고</label>
						<input class="textsquare1" id ="complogo1" value="${}"> <p> --%>
				<div>
					<div class="middleTitle_anno_text">
						<label for="compimg3">회사 이미지</label>
					</div>
					<input class="imagesquare1" name="com_img" type="image"
						src="${compInfo.com_img}" alt="이미지 없음"
						onerror="this.src='/img/dj/no_Image.gif'" id="compimg3"
						value="${compInfo.com_img}">
				</div>
				<p>
					<!-- 회사 환경 이미지 넣기  시작-->
					
					
					
						 <form id="addForm">
						        <div style="display: inline;">
						            <label for="img_upload">
						                <img src="/img/dj/fileaddbtn.png" style="width:100px; height:100px; cursor: pointer;">
						            </label>
						            <input type="file" name="img_upload" id="img_upload"
						                   onchange="previewImage(this,'View_area')"
						                   style="display: none;" multiple>
						 
						            <span id='View_area'
						                  style='position:relative; color: black; border: 0px solid black;'>
							        </span>
							        </div>
							 
							        <div style="align-content: center; width: 100%; text-align: center;">
							            <input type="button" class="btn" style="background: #F1C40F; color: #000000;" onclick="dataSubmit();"
							                   value="전송하기">
							        </div>
							 
							        <div id="resultDiv">
							            <p ><c:out value="${log}"></c:out> </p>
						        </div>
   						 </form>


					<!-- 회사 환경 이미지 넣기 끝 -->
				<div>
					<div class="middleTitle_anno">회사 주소</div>
					<%-- <input class="textsquare_addr" type="text" name="com_addr" id="compaddr1" value="${compInfo.com_addr}"> --%>
					<div class="textsquare_addr">${compInfo.com_addr}</div>
				</div>
				<p>
			</div>

			<hr size="5px">

			<form action="DjAnnoWriting" method="post">
			
				<div style="display:none"> <!-- type hidden으로 정보가 안넘겨져서 이 방법을 사용함  -->
				<input type="text" name="com_id" value="${compInfo.com_id}">
				<input type="text" name="com_name" value="${compInfo.com_name}">
				<input type="text" name="com_bus" value="${compInfo.com_bus}">
				</div>
				<div class="annoWriteContainer">



					<div class="bigTitle_anno">모집 내용</div>

					<div class="titleContainer">
						<div class="middleTitle_anno">공고 제목</div>
						<input type="text" class="anno_title_insert" name="anno_title"
							placeholder="공고 제목을 입력하세요." required="required">
					</div>

					<div>
						<div class="middleTitle_anno">
							<label for="annoJob1">모집 직종</label>
						</div>
						<select name="job_tag" id="annoJob1">
							<c:forEach var="jobTech1" items="${jobTech1}">
								<option value="${jobTech1.sub_cat}">${jobTech1.comm_ctx}</option>
							</c:forEach>
						</select>
						<p>
						<div>
							<div class="middleTitle_anno">고용 형태</div>
							<input type="radio" id="one" name="emp_type" value="1"
								checked="checked"> 정규직 <input type="radio" id="two"
								name="emp_type" value="2"> 계약직 <input type="radio"
								id="three" name="emp_type" value="3"> 파견직
							<p>
						</div>

						<div class="middleTitle_anno">
							<label for="recVol1">모집 인원</label>
						</div>
						<input type="text" name="rec_vol" required="required">명
						<p>
						<div class="middleTitle_anno">기술 스택1</div>
						<select name="tech_tag1">
							<c:forEach var="jobTech2" items="${jobTech2}">

								<option value="${jobTech2.sub_cat}">${jobTech2.comm_ctx}</option>

							</c:forEach>
						</select>
						<p>
						<div class="middleTitle_anno">기술 스택2</div>
						<select name="tech_tag2">
							<c:forEach var="jobTech2" items="${jobTech2}">

								<option value="${jobTech2.sub_cat}">${jobTech2.comm_ctx}</option>

							</c:forEach>
						</select>
						<p>
						<div class="middleTitle_anno">
							<label for="annoteck1">학력 사항</label>
						</div>
						<select name="rec_edu">
							<c:forEach var="recEdu" items="${recEdu}">

								<option value="${recEdu.comm_ctx}">${recEdu.comm_ctx}</option>

							</c:forEach>
						</select>
						<p>
						<div>
							<div class="middleTitle_anno">경력</div>
							<input type="radio" id="one11" name="career" value="001"checked="checked"> 신입 
							<input type="radio" id="two22" name="career" value="002"> 경력직(연차무관) 
							<input type="radio" id="three33" name="career" value="003"> 경력무관 
							<input type="radio" id="four44" name="career" value="004"> 3년 이상
							<input type="radio" id="five55" name="career" value="005"> 5년 이상 
							<input type="radio" id="six66" name="career" value="006"> 10년 이상
							<p>
						</div>

						<div>
							<div class="middleTitle_anno_text">모집 상세</div>
							<textarea name="rec_dtl" rows="40" cols="50"></textarea>
						</div>
						<p>
					</div>
				</div>

				<hr size="5px">

				<div class="annoCondContainer">
					<div class="bigTitle_anno">근무 조건</div>
					<div>
						<div class="middleTitle_anno">급여정보</div>
						<input type="number" name="pay_info" id="pay_info" value='0'>
						원
						<button type="button" id="salButton" onclick="buttontoggle();">급여협의</button>

					</div>
					<p>
					<div>
						<div class="middleTitle_anno_text">상세 근무 조건</div>
						<textarea name="work_cdt" rows="30" cols="50" required="required"></textarea>
					</div>
					<p>
					<div>
						<div class="middleTitle_anno_text">기타 입력 사항</div>
						<textarea name="etc_cdt" rows="40" cols="50"></textarea>
					</div>
					<p>
				</div>

				<hr size="5px">

				<div class="annoOptContainer">
					<div class="bigTitle_anno">공고 설정</div>
					<div class="middleTitle_anno">공고 시작일</div>

					<input type="date" id="regdate" value="anno_regdate"
						name="anno_regdate" required="required" onchange="addMonth();">

					<input type="date" class="input_anno_c_regdate"
						name="anno_c_regdate" id="c_regdate">

					<div class="anno_date_notice1">
						<h2>공고는 작성일로부터 한 달간 게시됩니다.</h2>
					</div>


				</div>

				<hr size="5px">

				<button type="submit" name="gobut" class="gobut">공고 작성 완료하기
				</button>

			</form>

			<br>
			<br>
			<%@ include file="footer.jsp"%>
			<br>
			<br>
		</div>
	</div>
</body>
</html>